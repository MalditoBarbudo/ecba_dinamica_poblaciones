<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Acceso compadre y GBIF desde R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Víctor Granda" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
    <link rel="stylesheet" href="custom-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Acceso compadre y GBIF desde R
]
.subtitle[
## Estudio de Casos Biología Ambiental
]
.author[
### Víctor Granda
]
.institute[
### Ecosystem Modelling Facility (CREAF)
]
.date[
### 2023/05/17
]

---

layout: false
class: inverse

# Com(p)adre



---

# Com(p)adre

COM(P)ADRE es un repositorio online de modelos de matrices poblacionales, así como
metadatos de plantas, animales, bacterias, virus, algas y hongos.

Se separa en dos bases de datos, COMADRE para animales, bacterias y virus, y 
COMPADRE para plantas, algas y hongos.

https://compadre-db.org/


.pull-left[![](img/comadre.png)]
.pull-right[![](img/compadre.png)]  

---

# Compadre en R

Lo primero que tenemos que hacer es instalar las librerías de R que vamos a necesitar y cargarlas para poder
usarlas


```r
install.packages('Rcompadre')
install.packages('dplyr')
install.packages('ggplot2')

# Ahora cargamos los paquetes
library(Rcompadre)
library(popdemo)
library(dplyr)
library(ggplot2)
```


```
## Welcome to popdemo! This is version 1.3-0
## Use ?popdemo for an intro, or browseVignettes('popdemo') for vignettes
## Citation for popdemo is here: doi.org/10.1111/j.2041-210X.2012.00222.x
## Development and legacy versions are here: github.com/iainmstott/popdemo
```

```
## Linking to GEOS 3.11.2, GDAL 3.7.0, PROJ 9.2.0; sf_use_s2() is TRUE
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

---

# Compadre en R


```r
# Obtener la última versión de compadre -----------------------------------------------------------------
# guardar la bd
compadre_db &lt;- cdb_fetch('compadre')
```

```
## This is COMPADRE version 6.23.5.0 (release date May_06_2023)
## See user agreement at https://compadre-db.org/Help/UserAgreement
## See how to cite with `citation(Rcompadre)`
```

---
class: .code80

# Compadre en R


```r
# comprobar que tenemos lo que queremos
compadre_db
```

```
## A COM(P)ADRE database ('CompadreDB') object with 792 SPECIES and 8994 MATRICES.
## 
## # A tibble: 8,994 × 59
##    mat        MatrixID SpeciesAuthor     SpeciesAccepted CommonName Kingdom Phylum
##    &lt;list&gt;        &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
##  1 &lt;CompdrMt&gt;   238259 Abies_balsamea    Abies balsamea  Balsam Fir Plantae Pinop…
##  2 &lt;CompdrMt&gt;   238260 Abies_balsamea    Abies balsamea  Balsam Fir Plantae Pinop…
##  3 &lt;CompdrMt&gt;   238261 Agave_angustifol… Agave vivipara  Caribbean… Plantae Magno…
##  4 &lt;CompdrMt&gt;   238262 Agave_angustifol… Agave vivipara  Caribbean… Plantae Magno…
##  5 &lt;CompdrMt&gt;   238263 Allium_vineale    Allium vineale  &lt;NA&gt;       Plantae Magno…
##  6 &lt;CompdrMt&gt;   238265 Araucaria_cunnin… Araucaria cunn… &lt;NA&gt;       Plantae Pinop…
##  7 &lt;CompdrMt&gt;   238266 Araucaria_cunnin… Araucaria cunn… &lt;NA&gt;       Plantae Pinop…
##  8 &lt;CompdrMt&gt;   238271 Ascophyllum_nodo… Ascophyllum no… &lt;NA&gt;       Chroma… Heter…
##  9 &lt;CompdrMt&gt;   238272 Ascophyllum_nodo… Ascophyllum no… &lt;NA&gt;       Chroma… Heter…
## 10 &lt;CompdrMt&gt;   238273 Ascophyllum_nodo… Ascophyllum no… &lt;NA&gt;       Chroma… Heter…
## # ℹ 8,984 more rows
## # ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
## #   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
## #   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
## #   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
## #   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,
## #   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;, …
```

---
class: .code80

# Compadre en R


```r
# comprobar que tenemos lo que queremos
names(compadre_db)
```

```
##  [1] "mat"                    "MatrixID"               "SpeciesAuthor"         
##  [4] "SpeciesAccepted"        "CommonName"             "Kingdom"               
##  [7] "Phylum"                 "Class"                  "Order"                 
## [10] "Family"                 "Genus"                  "Species"               
## [13] "Infraspecies"           "InfraspeciesType"       "OrganismType"          
## [16] "DicotMonoc"             "AngioGymno"             "Authors"               
## [19] "Journal"                "SourceType"             "OtherType"             
## [22] "YearPublication"        "DOI_ISBN"               "AdditionalSource"      
## [25] "StudyDuration"          "StudyStart"             "StudyEnd"              
## [28] "ProjectionInterval"     "MatrixCriteriaSize"     "MatrixCriteriaOntogeny"
## [31] "MatrixCriteriaAge"      "MatrixPopulation"       "NumberPopulations"     
## [34] "Lat"                    "Lon"                    "Altitude"              
## [37] "Country"                "Continent"              "Ecoregion"             
## [40] "StudiedSex"             "MatrixComposite"        "MatrixSeasonal"        
## [43] "MatrixTreatment"        "MatrixCaptivity"        "MatrixStartYear"       
## [46] "MatrixStartSeason"      "MatrixStartMonth"       "MatrixEndYear"         
## [49] "MatrixEndSeason"        "MatrixEndMonth"         "CensusType"            
## [52] "MatrixSplit"            "MatrixFec"              "Observations"          
## [55] "MatrixDimension"        "SurvivalIssue"          "_Database"             
## [58] "_PopulationStatus"      "_PublicationStatus"
```

---
class: .code80

# Compadre en R


```r
# Comprobar especies ------------------------------------------------------------------------------------
# Podemos comprobar si nuestras especies de interes están presentes
species_wanted &lt;- c("Pinus nigra", "Acer saccharum")
cdb_check_species(compadre_db, species_wanted)
```

```
##          species in_db
## 1    Pinus nigra  TRUE
## 2 Acer saccharum  TRUE
```

---
class: .code80

# Compadre en R


```r
# Podemos comprobar y a la vez sacar los datos para esas especies
compadre_species_wanted &lt;- cdb_check_species(compadre_db, species_wanted, return_db = TRUE) 
compadre_species_wanted
```

```
## A COM(P)ADRE database ('CompadreDB') object with 2 SPECIES and 16 MATRICES.
## 
## # A tibble: 16 × 59
##    mat        MatrixID SpeciesAuthor     SpeciesAccepted CommonName Kingdom Phylum
##    &lt;list&gt;        &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; 
##  1 &lt;CompdrMt&gt;   238967 Pinus_nigra       Pinus nigra     Black pine Plantae Pinop…
##  2 &lt;CompdrMt&gt;   247339 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  3 &lt;CompdrMt&gt;   247340 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  4 &lt;CompdrMt&gt;   247341 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  5 &lt;CompdrMt&gt;   247342 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  6 &lt;CompdrMt&gt;   247343 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  7 &lt;CompdrMt&gt;   247344 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  8 &lt;CompdrMt&gt;   247345 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
##  9 &lt;CompdrMt&gt;   247346 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
## 10 &lt;CompdrMt&gt;   247347 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
## 11 &lt;CompdrMt&gt;   247348 Acer_saccharum    Acer saccharum  Sugar map… Plantae Magno…
## 12 &lt;CompdrMt&gt;   247810 Pinus_nigra_subs… Pinus nigra     Black pine Plantae Pinop…
## 13 &lt;CompdrMt&gt;   247811 Pinus_nigra_subs… Pinus nigra     Black pine Plantae Pinop…
## 14 &lt;CompdrMt&gt;   247812 Pinus_nigra_subs… Pinus nigra     Black pine Plantae Pinop…
## 15 &lt;CompdrMt&gt;   247813 Pinus_nigra_subs… Pinus nigra     Black pine Plantae Pinop…
## 16 &lt;CompdrMt&gt;   247814 Pinus_nigra_subs… Pinus nigra     Black pine Plantae Pinop…
## # ℹ 52 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;,
## #   Species &lt;chr&gt;, Infraspecies &lt;chr&gt;, InfraspeciesType &lt;chr&gt;,
## #   OrganismType &lt;chr&gt;, DicotMonoc &lt;chr&gt;, AngioGymno &lt;chr&gt;, Authors &lt;chr&gt;,
## #   Journal &lt;chr&gt;, SourceType &lt;chr&gt;, OtherType &lt;chr&gt;, YearPublication &lt;chr&gt;,
## #   DOI_ISBN &lt;chr&gt;, AdditionalSource &lt;chr&gt;, StudyDuration &lt;chr&gt;,
## #   StudyStart &lt;chr&gt;, StudyEnd &lt;chr&gt;, ProjectionInterval &lt;chr&gt;,
## #   MatrixCriteriaSize &lt;chr&gt;, MatrixCriteriaOntogeny &lt;chr&gt;, …
```

---

# Compadre en R

## *Primula vulgaris*, un ejemplo de uso de COMPADRE


.pull-left[.center[![](img/250px-Primula_vulgaris.jpg)]]
.pull-right[
Vamos a hacer un ejemplo con *Primula vulgaris*, una primulácea común en la península.
]

---
class: .code80

# Compadre en R


```r
# Más específico, Primula vulgaros solamente en España
compadre_primula_spain &lt;- subset(
  compadre_db,
  SpeciesAccepted == 'Primula vulgaris' &amp; Country == 'ESP'
)
# comprobamos que, efectivamente, solo tenemos datos para Primula en España
compadre_primula_spain$SpeciesAccepted
```

```
##  [1] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
##  [5] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
##  [9] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [13] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [17] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [21] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [25] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [29] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [33] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [37] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [41] "Primula vulgaris" "Primula vulgaris" "Primula vulgaris" "Primula vulgaris"
## [45] "Primula vulgaris" "Primula vulgaris"
```

```r
compadre_primula_spain$Country
```

```
##  [1] "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP"
## [14] "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP"
## [27] "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP"
## [40] "ESP" "ESP" "ESP" "ESP" "ESP" "ESP" "ESP"
```

```r
# Para ver toda la información
# View(compadre_primula_spain@data)
```

---
class: .code80

# Compadre en R


```r
# Extraer matrices --------------------------------------------------------------------------------------
# Podemos sacar matrices de población
primula_matA &lt;- matA(compadre_primula_spain)

# Para saber a que corresponden los estadíos (A1, A2...)
matrixClass(compadre_primula_spain)
```

```
## [[1]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245197
## 2               active           Juvenile                 2   245197
## 3               active   Vegetative adult                 3   245197
## 4               active Reproductive adult                 4   245197
## 
## [[2]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245198
## 2               active           Juvenile                 2   245198
## 3               active   Vegetative adult                 3   245198
## 4               active Reproductive adult                 4   245198
## 
## [[3]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245199
## 2               active           Juvenile                 2   245199
## 3               active   Vegetative adult                 3   245199
## 4               active Reproductive adult                 4   245199
## 
## [[4]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245200
## 2               active           Juvenile                 2   245200
## 3               active   Vegetative adult                 3   245200
## 4               active Reproductive adult                 4   245200
## 
## [[5]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245201
## 2               active           Juvenile                 2   245201
## 3               active   Vegetative adult                 3   245201
## 4               active Reproductive adult                 4   245201
## 
## [[6]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245202
## 2               active           Juvenile                 2   245202
## 3               active   Vegetative adult                 3   245202
## 4               active Reproductive adult                 4   245202
## 
## [[7]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245203
## 2               active           Juvenile                 2   245203
## 3               active   Vegetative adult                 3   245203
## 4               active Reproductive adult                 4   245203
## 
## [[8]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245204
## 2               active           Juvenile                 2   245204
## 3               active   Vegetative adult                 3   245204
## 4               active Reproductive adult                 4   245204
## 
## [[9]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245205
## 2               active           Juvenile                 2   245205
## 3               active   Vegetative adult                 3   245205
## 4               active Reproductive adult                 4   245205
## 
## [[10]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245206
## 2               active           Juvenile                 2   245206
## 3               active   Vegetative adult                 3   245206
## 4               active Reproductive adult                 4   245206
## 
## [[11]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245207
## 2               active           Juvenile                 2   245207
## 3               active   Vegetative adult                 3   245207
## 4               active Reproductive adult                 4   245207
## 
## [[12]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245208
## 2               active           Juvenile                 2   245208
## 3               active   Vegetative adult                 3   245208
## 4               active Reproductive adult                 4   245208
## 
## [[13]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245209
## 2               active           Juvenile                 2   245209
## 3               active   Vegetative adult                 3   245209
## 4               active Reproductive adult                 4   245209
## 
## [[14]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245210
## 2               active           Juvenile                 2   245210
## 3               active   Vegetative adult                 3   245210
## 4               active Reproductive adult                 4   245210
## 
## [[15]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245211
## 2               active           Juvenile                 2   245211
## 3               active   Vegetative adult                 3   245211
## 4               active Reproductive adult                 4   245211
## 
## [[16]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245212
## 2               active           Juvenile                 2   245212
## 3               active   Vegetative adult                 3   245212
## 4               active Reproductive adult                 4   245212
## 
## [[17]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245213
## 2               active           Juvenile                 2   245213
## 3               active   Vegetative adult                 3   245213
## 4               active Reproductive adult                 4   245213
## 
## [[18]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245214
## 2               active           Juvenile                 2   245214
## 3               active   Vegetative adult                 3   245214
## 4               active Reproductive adult                 4   245214
## 
## [[19]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245215
## 2               active           Juvenile                 2   245215
## 3               active   Vegetative adult                 3   245215
## 4               active Reproductive adult                 4   245215
## 
## [[20]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245216
## 2               active           Juvenile                 2   245216
## 3               active   Vegetative adult                 3   245216
## 4               active Reproductive adult                 4   245216
## 
## [[21]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245217
## 2               active           Juvenile                 2   245217
## 3               active   Vegetative adult                 3   245217
## 4               active Reproductive adult                 4   245217
## 
## [[22]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245218
## 2               active           Juvenile                 2   245218
## 3               active   Vegetative adult                 3   245218
## 4               active Reproductive adult                 4   245218
## 
## [[23]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245219
## 2               active           Juvenile                 2   245219
## 3               active   Vegetative adult                 3   245219
## 4               active Reproductive adult                 4   245219
## 
## [[24]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245220
## 2               active           Juvenile                 2   245220
## 3               active   Vegetative adult                 3   245220
## 4               active Reproductive adult                 4   245220
## 
## [[25]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245221
## 2               active           Juvenile                 2   245221
## 3               active   Vegetative adult                 3   245221
## 4               active Reproductive adult                 4   245221
## 
## [[26]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245222
## 2               active           Juvenile                 2   245222
## 3               active   Vegetative adult                 3   245222
## 4               active Reproductive adult                 4   245222
## 
## [[27]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245223
## 2               active           Juvenile                 2   245223
## 3               active   Vegetative adult                 3   245223
## 4               active Reproductive adult                 4   245223
## 
## [[28]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245224
## 2               active           Juvenile                 2   245224
## 3               active   Vegetative adult                 3   245224
## 4               active Reproductive adult                 4   245224
## 
## [[29]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245225
## 2               active           Juvenile                 2   245225
## 3               active   Vegetative adult                 3   245225
## 4               active Reproductive adult                 4   245225
## 
## [[30]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245226
## 2               active           Juvenile                 2   245226
## 3               active   Vegetative adult                 3   245226
## 4               active Reproductive adult                 4   245226
## 
## [[31]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245227
## 2               active           Juvenile                 2   245227
## 3               active   Vegetative adult                 3   245227
## 4               active Reproductive adult                 4   245227
## 
## [[32]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245228
## 2               active           Juvenile                 2   245228
## 3               active   Vegetative adult                 3   245228
## 4               active Reproductive adult                 4   245228
## 
## [[33]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245229
## 2               active           Juvenile                 2   245229
## 3               active   Vegetative adult                 3   245229
## 4               active Reproductive adult                 4   245229
## 
## [[34]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245230
## 2               active           Juvenile                 2   245230
## 3               active   Vegetative adult                 3   245230
## 4               active Reproductive adult                 4   245230
## 
## [[35]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245231
## 2               active           Juvenile                 2   245231
## 3               active   Vegetative adult                 3   245231
## 4               active Reproductive adult                 4   245231
## 
## [[36]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245232
## 2               active           Juvenile                 2   245232
## 3               active   Vegetative adult                 3   245232
## 4               active Reproductive adult                 4   245232
## 
## [[37]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245233
## 2               active           Juvenile                 2   245233
## 3               active   Vegetative adult                 3   245233
## 4               active Reproductive adult                 4   245233
## 
## [[38]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245234
## 2               active           Juvenile                 2   245234
## 3               active   Vegetative adult                 3   245234
## 4               active Reproductive adult                 4   245234
## 
## [[39]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245235
## 2               active           Juvenile                 2   245235
## 3               active   Vegetative adult                 3   245235
## 4               active Reproductive adult                 4   245235
## 
## [[40]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245236
## 2               active           Juvenile                 2   245236
## 3               active   Vegetative adult                 3   245236
## 4               active Reproductive adult                 4   245236
## 
## [[41]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245237
## 2               active           Juvenile                 2   245237
## 3               active   Vegetative adult                 3   245237
## 4               active Reproductive adult                 4   245237
## 
## [[42]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245238
## 2               active           Juvenile                 2   245238
## 3               active   Vegetative adult                 3   245238
## 4               active Reproductive adult                 4   245238
## 
## [[43]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245239
## 2               active           Juvenile                 2   245239
## 3               active   Vegetative adult                 3   245239
## 4               active Reproductive adult                 4   245239
## 
## [[44]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245240
## 2               active           Juvenile                 2   245240
## 3               active   Vegetative adult                 3   245240
## 4               active Reproductive adult                 4   245240
## 
## [[45]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245241
## 2               active           Juvenile                 2   245241
## 3               active   Vegetative adult                 3   245241
## 4               active Reproductive adult                 4   245241
## 
## [[46]]
##   MatrixClassOrganized  MatrixClassAuthor MatrixClassNumber MatrixID
## 1               active           Seedling                 1   245242
## 2               active           Juvenile                 2   245242
## 3               active   Vegetative adult                 3   245242
## 4               active Reproductive adult                 4   245242
```

---
class: .code80

# Compadre en R


```r
# Podemos obtener diferentes parámetros, como lambda, para cada una de las matrices:
# individualmente:
eigs(primula_matA[[1]], what = 'lambda')
```

```
## [1] 0.9125684
```

```r
# todas a la vez:
primula_lambdas &lt;- sapply(primula_matA, eigs, what = 'lambda')
summary(primula_lambdas)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.6836  0.8363  0.8952  0.8992  0.9518  1.2914
```

---
class: .code80

# Compadre en R


```r
# todas a la vez:
hist(primula_lambdas)
```

&lt;img src="compadre_y_gbif_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

---
class: .code80

# Compadre en R


```r
# Calcular dinámicas a partir de una población inicial --------------------------------------------------
# Creamos la matriz de población inicial a partir de los datos que hemos obtenido:
initial_pop_matrix &lt;- matrix(c(50, 38, 26, 80), byrow = FALSE, ncol = 1)

# ahora podemos saber que población tendremos en el siguiente ciclo reproductivo
primula_matA[[1]] %*% initial_pop_matrix
```

```
##         [,1]
## A1 156.64000
## A2  13.68535
## A3  27.47199
## A4  70.00269
```

---
class: .code80

# Compadre en R


```r
# O hacer un bucle (loop) para tener los próximos 25 ciclos
dinamica_primula_25 &lt;- initial_pop_matrix
for (year in 1:25) {
  dinamica_primula_25 &lt;- cbind(
    dinamica_primula_25,
    round(primula_matA[[1]] %*% dinamica_primula_25[,year], 0)
  )
}
dinamica_primula_25
```

```
##    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## A1   50  157  137  121  110  100   92   84   76    69    63    57    53    49
## A2   38   14   21   21   19   17   15   14   13    12    11    10     9     8
## A3   26   27   23   22   20   19   17   15   14    13    12    11    10     9
## A4   80   70   62   56   51   47   43   39   35    32    29    27    25    23
##    [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## A1    45    41    37    33    31    27    25    23    22    20    18    16
## A2     7     7     6     6     5     5     4     4     4     3     3     3
## A3     8     7     7     6     6     5     5     4     4     4     3     3
## A4    21    19    17    16    14    13    12    11    10     9     8     7
```

---
class: .code80

# Compadre en R


```r
# Y con esto hacer una gráfica con la tendencia
transposed_data &lt;- as.data.frame(t(dinamica_primula_25))
transposed_data$cycle &lt;- 0:25

plot(transposed_data$cycle, transposed_data$A1, col = 'blue', type = 'l', ylim = c(0,180))
lines(transposed_data$cycle, transposed_data$A2, col = 'red', type = 'l')
lines(transposed_data$cycle, transposed_data$A3, col = 'yellow', type = 'l')
lines(transposed_data$cycle, transposed_data$A4, col = 'green', type = 'l')
```

&lt;img src="compadre_y_gbif_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

---
class: .code80

# Compadre en R


```r
# Otra forma
transposed_data |&gt;
  tidyr::pivot_longer(cols = A1:A4, names_to = 'Estadío') |&gt;
  ggplot(aes(x = cycle, y = value, color = Estadío)) +
  geom_line()
```

&lt;img src="compadre_y_gbif_files/figure-html/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /&gt;

---
layout: false
class: inverse

# GBIF

---

# GBIF

GBIF (Global Biodiversity Information Facility) es una red internacional, así como una infraestructura de datos financiada y mantenida por
diferentes gobiernos de todo el mundo cuyo objetivo es proveer de datos abierto sobre todo tipo de vida
en la tierra.

En cuanto a lo que nos interesa hoy, ofrece datos de presencia de especies en todo el mundo, basados en
datos suministrados por investigadores, gobiernos...

.center[![](img/gbif_logo.png)]

---
class: .code80

# GBIF en R


```r
# Acceso a la base de datos GBIF ------------------------------------------------------------------------
# Primer paso es instalar los paquetes si no los tenemos instalados
install.packages('spocc')
install.packages('leaflet')

# Ahora cargamos los paquetes
library(spocc)
library(dplyr)
library(leaflet)
```



---
class: .code80

# GBIF en R


```r
# Consultar datos para una especie ----------------------------------------------------------------------
primula_gbif &lt;- occ(query = 'Primula vulgaris', from = 'gbif', has_coords = TRUE, limit = 1000)
primula_gbif
```

```
## Searched: gbif
## Occurrences - Found: 147,283, Returned: 1,000
## Search type: Scientific
##   gbif: Primula vulgaris (1000)
```

---
class: .code80

# GBIF en R


```r
# Plotear el mapa ---------------------------------------------------------------------------------------
primula_gbif$gbif$data$Primula_vulgaris |&gt;
  sf::st_as_sf(coords = c("longitude", "latitude"), crs = 4326) |&gt;
  leaflet(
    
  ) |&gt;
  addTiles() |&gt;
  addMarkers()
```

<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f2466f86ab92182a4079" style="width:504px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-f2466f86ab92182a4079">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[46.04611,43.95012,50.677205,48.090906,45.903806,42.128933,46.858511,46.607196,46.911955,48.009457,48.008773,46.987812,46.990567,45.655569,46.779518,44.413416,43.360982,43.23705,46.167365,45.981677,48.198136,44.226822,44.216103,52.978093,45.835963,48.213874,51.423805,47.831658,45.888717,49.974828,54.412312,45.703882,48.022875,46.952752,47.275464,46.749616,52.946228,45.814859,46.123809,46.464111,46.914895,46.916017,44.954461,50.919739,48.701389,53.087652,50.981973,45.957676,48.757943,46.805022,46.805705,46.805777,46.783807,44.319614,43.337854,48.704167,48.009121,48.008926,48.008661,46.77235,46.946225,45.960607,46.78823,46.791838,46.587803,45.996205,47.635188,45.382263,45.810361,48.19805,45.919406,45.832863,41.788828,41.627162,50.736619,48.299903,46.97296,46.961992,45.585099,48.289072,43.399672,50.720267,51.454846,54.649355,44.338088,48.301624,45.02317,44.591388,44.60071,44.654917,54.803303,54.800425,45.852219,51.43417,45.169237,45.786017,46.829235,46.910912,45.026233,46.960062,47.551514,53.284359,53.28437,41.097937,43.523214,43.524631,51.850185,45.775423,51.596408,46.909308,46.909317,50.066776,47.525519,40.600424,46.919558,46.913428,46.893518,45.942,40.601574,43.627842,43.627647,46.9104,50.484418,50.484985,46.983848,45.735502,47.033988,43.269063,45.700488,45.13948,42.135929,45.120662,50.794322,48.168905,45.522002,45.819744,45.480833,54.972972,50.85,46.62978,48.023294,44.905151,50.867445,48.060366,52.05,51.9,43.109486,51.55,51.9,52.3,52.3,52.3,52.3,52.3,51.55,51.55,43.1164,51.538712,42.065365,56.044497,50.906605,52.555591,56.432108,56.431678,52.78649,55.046425,50.955187,49.94831,49.9482,49.94819,49.94819,49.94819,49.94819,52.696793,45.341487,51.07805,43.372477,47.282212,47.282237,51.469319,51.408367,51.118081,44.584679,44.58596,44.588967,43.384183,46.191233,47.709332,47.002452,47.007547,46.947352,47.074585,45.959175,44.5498,49.998617,45.811222,48.024443,48.022711,48.019572,45.772151,43.142334,44.974949,50.983372,45.371962,50.170509,45.1735,47.102353,48.179719,50.98332,47.036665,47.026417,45.719953,46.911458,46.911847,50.324405,43.558594,43.338543,43.330801,45.866719,53.770322,46.881088,45.740478,49.55827,44.407046,46.998517,40.306016,40.250503,51.069,45.709014,43.426615,46.172129,50.0938,45.466343,50.926168,47.478809,46.875822,45.827013,45.689914,46.105316,46.113213,44.305855,45.75571,45.127456,47.551544,47.551544,47.551544,47.133781,48.563879,46.19488,45.824539,44.289852,48.488153,39.676895,44.626642,48.412284,50.043274,54.210442,52.799906,51.335633,42.152174,43.485393,43.478238,52.971765,47.108382,46.83833,46.838437,47.108382,43.557214,43.339203,48.134368,52.093345,45.448745,45.560974,45.706197,46.83334,45.82534,45.806102,43.673261,45.91939,45.142602,42.234056,48.382608,54.505283,46.752738,45.914267,45.915323,45.918725,45.912345,46.732455,41.179924,45.882337,45.740438,45.740336,45.740302,45.740446,45.74021,46.002281,55.850848,46.737859,50.667131,46.88483,46.886263,46.983942,45.742616,46.98883,39.716837,48.230838,46.365137,47.144543,51.47287,53.346202,54.381355,41.203024,43.807729,51.533144,42.98975,45.73124,52.261672,45.501235,45.501235,45.880985,46.169482,45.818721,51.071259,45.652358,45.130201,45.801085,50.896206,47.275463,45.973723,47.01344,47.010502,45.12333,41.798714,51.866015,41.09673,51.434137,48.179565,48.091633,47.651531,50.383947,50.383753,50.38369,50.383952,50.383376,46.168915,50.38386,48.427467,45.391022,45.827031,45.354065,44.476112,45.783085,50.38305,50.384392,45.641274,45.7764,47.86222,45.889568,45.818553,44.878706,46.121091,48.219119,47.088894,46.762286,44.918442,44.896487,44.083564,48.17788,46.911647,48.031739,50.973414,45.783121,48.179978,52.379787,45.731155,45.862108,48.14303,47.145389,48.154507,44.178198,46.102746,48.237482,51.076722,44.598785,45.953441,46.087039,45.683846,43.552588,45.988649,43.322418,44.660096,44.589604,53.380899,53.380787,48.289133,48.288981,48.288981,53.534333,46.369227,50.634097,54.454947,45.806053,46.641678,51.535531,48.152105,44.107452,45.171485,45.829812,48.709087,46.289114,45.093389,50.908428,46.909425,46.910188,44.578761,40.97074,47.155774,45.846625,45.190687,44.067819,44.080083,42.131145,46.188159,36.891498,53.000545,44.083471,45.716871,50.988749,44.107849,51.447091,51.474138,44.714595,54.184022,51.84927,43.887841,51.19548,54.866951,40.090368,48.702104,43.434323,46.942082,50.376049,40.597533,53.940816,52.903512,45.893079,48.203611,44.608827,51.413078,45.711638,45.719923,49.303597,43.265856,44.607414,44.601202,51.803977,46.151647,43.10318,51.743764,46.683928,56.128765,37.906993,40.741269,51.619708,48.896389,42.399755,56.888521,42.167533,41.810707,44.303577,43.149874,48.863111,48.391162,37.321121,41.136177,43.365274,46.15702,45.371912,52.762805,51.057789,50.105556,41.096676,48.289133,48.14441,48.134159,48.134241,45.29073,43.0737,43.323633,43.323448,52.4,52.3,51.9,51.45,51.55,43.311927,50.997302,51.9,52.35,53.35,43.235957,50.767501,45.942963,52,52,52,52,54.006104,51.95,45.943962,52.3,51.5,51.538109,43.143564,43.124686,51.45,51.55,43.0732,51.55,46.952426,43.2536,51.55,43.0942,43.214864,52.5,46.160778,51.8,51.9,43.3807,43.30667,52.2,52.3,51.55,41.531398,43.457772,47.280285,51.9,51.8,49.9104,51.9,49.852322,51.8,46.0968,51.8,52,52.95,51.55,53.15,52.35,50.921937,51.55,52.5,52.35,51.9,49.80011,52.110412,47.792241,52.35,53.336151,52.35,52.35,44.917245,51.9,47.257916,51.8,46.669518,52.95,42.2084,52.45,56.587134,52.673007,56.324943,50.86934,52.165302,56.586714,51.97992,55.154833,50.776145,56.67853,51.989078,52.76125,50.968461,47.73937,58.896829,59.209705,59.030195,59.03038,59.030916,54.783971,55.023658,55.541425,52.409581,54.811184,51.996848,52.621114,43.605105,43.60483,43.696178,48.241709,47.216288,54.873657,43.069005,48.382977,46.908455,45.14429,51.463186,46.926436,43.53629,44.096029,51.434314,44.052374,48.121712,48.176099,48.072752,57.06618,48.762303,48.008509,48.008688,44.513126,55.832031,52.34303,50.839932,47.124281,44.41198,48.135231,48.135383,48.134304,48.134201,45.003052,51.906609,48.812022,45.779729,45.726222,48.202807,45.94933,48.231471,45.863892,44.474927,44.325477,44.927575,51.085147,50.759363,43.348896,53.763542,43.351775,45.790401,48.240845,47.090933,48.084733,45.591789,50.328408,43.654446,51.430389,55.180536,46.123806,46.991785,48.009481,53.087139,47.92119,47.920683,45.813605,47.999834,47.056017,46.91128,53.624341,37.332187,35.005531,44.493947,52.203373,44.39171,52.93673,46.511982,45.643999,50.103122,47.089278,48.238999,47.353244,50.102607,45.65723,54.546789,45.446014,45.551096,45.680331,51.805776,48.094933,47.022269,45.819613,43.264061,45.76841,45.731288,45.731288,44.837569,51.205018,46.068328,44.865399,50.407459,45.752014,51.216821,46.905291,47.18727,45.56178,45.748616,44.837569,44.227672,43.535137,45.7843,46.174561,50.613705,53.771708,50.76477,51.210944,44.878621,45.786788,48.718862,45.646301,48.42554,45.015022,48.181543,50.7071,48.105254,44.951705,44.078611,51.871769,48.487705,47.122696,53.265128,45.702204,47.082825,45.734682,47.082706,47.082848,47.082658,47.267562,47.267624,47.286062,48.219605,44.312659,44.050452,44.931846,47.082415,47.082405,47.082234,47.082371,47.081776,48.240182,47.075646,45.752342,41.568997,45.071626,44.896488,45.65147,39.897023,39.897023,39.897023,39.897023,39.893072,46.83965,44.900383,48.152631,43.247684,46.166506,44.861141,50.868772,50.868737,50.871052,47.08279,47.082892,47.08283,48.830433,45.779992,50.868796,50.868798,50.868802,50.868619,50.86865,50.868612,50.871146,51.16782,56.424424,48.008649,46.893227,46.944095,47.710217,50.868606,46.947312,56.770451,47.638152,47.957983,50.871275,46.94851,43.324719,42.869442,42.869894,52.202533,48.134703,50.021917,48.815204,46.691242,45.334768,45.33338,45.332761,45.150109,47.067132,44.935291,47.283812,46.47374,46.47374,50.922282,45.701743,45.33289,56.919552,50.855561,44.679225,44.67911,44.678562,45.14592,45.896778,47.806261,47.995166,45.644832,45.776189,46.870701,47.104801,42.998011,44.173617,46.179309,49.725895,48.062367,51.025101,44.109751,46.773216,47.503872,51.410077,50.759386,42.114193,44.915833,44.914885,44.522698,41.998679,46.948542,45.726469,55.959708,43.618647,45.740579,51.676653,46.144984,45.142745,47.274709,42.619647,48.153816,51.181053,45.814947,53.535729,45.818981,45.789308,54.6051,47.041503,50.121944,48.12,48.126894,45.079559,54.441285,45.958168,52.74408,45.053392,48.117877,44.33149,48.121041,45.056541,52.180852,47.390339,47.159639,48.145373,45.808182,47.07042,47.070308,52.14664,45.142712,43.549267,43.54903,53.149141,46.060687,51.14115,43.55308,47.687927,47.117242,43.558012,48.019327,45.940747,47.080866,47.096969,45.757706,46.919352,46.321377,43.987888,44.206906,45.693015,41.51672,48.194186,50.703644,48.189358,48.806636,51.58648,51.586483,51.586535,51.586402,51.586461,51.58632,48.235458,51.532188,51.027747,51.586528,52.801118,45.79599,49.119362,42.173134,45.878362,42.164644,45.765489,44.387321,45.696855,50.918966,51.624227,51.441961,51.4419,47.108382,46.94679,42.963963,46.216767,44.846709,51.408227,50.98352,44.917685,50.440954,44.939527,53.245963,43.550067,50.814881,51.447067,43.160864,52.787787,33.57118,43.159256,44.43039,45.438428,51.355797,42.939095,51.829137,43.266625,43.266625,38.857762,45.105809,48.426097,51.72523,43.691291,44.308688,47.103341,44.836983,47.083694,45.146829,45.865317,45.865289,45.864242,51.658441,48.194367,44.73613,44.971108,42.71851,45.166154,44.837569,46.472595,40.611556,40.611594,48.157155,51.182822,42.966401,51.529928,45.9377,45.164052,48.19347,48.564016,51.429199,40.949661,50.705596,51.577974,43.143561,43.183114,43.184743,55.159424,45.146785,51.881776,45.065647,48.474354,48.474921,48.42853,48.41112,45.963471,47.074607,50.910942],[6.334537,11.746948,-3.243391,16.172794,9.86366,1.942312,13.92778,14.701323,16.287495,16.222842,16.222931,15.852202,15.8563,8.139128,15.879313,33.929269,-3.423968,-5.451778,11.131154,12.148061,16.251803,10.767617,10.768145,-1.153632,9.827655,15.650854,-0.569128,16.126892,9.900605,14.385597,-1.965595,9.911504,16.204866,15.797212,14.770903,14.167183,-1.237784,11.74943,13.50794,13.957307,15.735595,15.746027,9.353454,-2.621703,2.1975,-2.976623,-1.445087,12.117302,19.053065,15.84333,15.842757,15.842463,15.844185,7.445031,-5.953901,2.198333,16.222728,16.222746,16.22391,15.900192,16.310297,12.067014,15.723837,15.72456,14.625311,10.3519,11.307051,17.771573,16.026758,16.249121,6.143392,9.909028,-8.504953,-8.404882,-2.106091,25.920919,15.919232,15.92102,9.963922,16.326644,39.969928,-3.220721,-2.107701,-1.745681,8.144108,25.913058,34.800622,38.167445,38.168865,33.874308,-1.326985,-1.33761,22.897053,-2.182551,8.288085,8.8902,15.927977,16.287808,7.419744,16.061243,7.606251,-3.803985,-3.803567,-8.557588,39.992503,39.990558,-0.544172,9.67796,-3.321246,16.088228,16.088178,-5.279324,7.608408,23.106744,16.081825,16.074477,16.057175,11.887712,23.104397,39.707264,39.707456,16.287155,-4.732506,-4.735386,6.854853,9.706089,15.945738,-8.308088,9.804901,7.972313,19.090961,7.991191,-2.33652,15.965569,6.061456,8.918973,11.463931,-2.103283,5.8,13.620245,16.012067,15.574884,1.591692,5.567153,5,4.05,-2.426786,3.55,4.05,4.8,4.8,4.8,4.8,4.8,3.5,3.5,-2.41003,9.93937,2.165862,-5.534641,-0.104267,-2.643033,-5.2858,-5.301988,-3.08136,-1.499941,-1.190999,5.07973,5.07961,5.07958,5.07973,5.07958,5.07958,-2.733077,7.610315,-2.533442,-1.660272,11.394274,11.394336,-0.262115,-2.233841,-3.150155,37.975685,37.975038,37.973065,-4.888967,9.96405,16.418697,15.685222,15.673118,16.073521,15.389797,6.214417,33.677017,14.559143,9.12739,16.193113,16.208949,16.194914,9.723952,-1.610924,8.167556,-4.340417,14.441549,-5.119055,8.255295,15.421422,16.232162,-2.752883,15.885275,15.890382,9.367275,16.2875,16.287337,-3.795485,-6.187339,-5.039278,-5.843761,10.970487,-0.366288,15.707838,8.499678,-1.335933,8.45989,15.89256,-7.036281,-7.094844,-0.10168,10.316826,39.96937,10.010181,8.239328,11.574111,11.575922,1.858399,15.892688,9.266675,9.781978,8.841441,11.118527,7.453244,4.592449,7.97916,7.606194,7.606194,7.606194,7.239613,2.186317,8.850858,8.831236,7.966582,2.721752,-8.859895,33.849718,-2.012671,9.041692,-0.803169,-1.456797,12.436721,19.121576,39.91537,39.932013,-1.137035,15.413799,15.949927,15.955105,15.413799,-6.781826,-4.966049,16.245508,1.31322,11.570942,8.688866,9.446018,15.992422,6.010415,9.831405,40.300514,6.143137,7.968118,-8.646594,-1.968667,-3.630017,8.18057,8.126212,8.125543,8.121987,8.125271,13.642812,28.960322,9.652905,8.494658,8.494589,8.49442,8.494592,8.494539,9.630947,-3.593503,13.626873,-1.101193,16.208883,16.211322,15.962392,9.694034,15.933867,-8.774312,16.33451,17.802143,15.382608,-2.18287,-2.768115,-1.928253,28.87976,7.212802,-0.466788,-3.949298,9.832373,-0.666978,6.027811,6.027811,9.865345,14.605614,16.016515,-0.945616,0.146837,7.978332,15.711048,-2.003132,14.770914,12.170252,15.909342,15.92215,7.249721,-8.133342,-8.521039,-8.485206,-2.182297,16.392054,3.454095,15.825917,-4.146279,-4.146218,-4.146022,-4.146385,-4.143861,16.834435,-4.14614,-2.025246,17.95418,8.929997,5.053192,11.288247,10.747846,-4.145755,-4.146744,10.035189,10.752401,16.165804,8.611137,8.964011,8.066668,14.676922,16.286134,15.437426,23.580234,8.118675,9.385868,39.088323,16.302878,16.2873,16.3114,-0.483443,8.601833,16.240194,-1.436539,9.699515,6.2192,16.226324,15.389247,16.254475,38.960059,15.412743,16.296579,-2.541353,8.08863,8.693648,6.729705,11.308704,39.818598,8.792803,-4.258325,7.919559,37.972395,-2.87019,-2.870243,16.3268,16.326901,16.326901,-2.304155,6.16903,-2.374905,-2.979793,9.830449,6.408046,-2.480224,16.249311,6.230451,7.959717,9.74396,2.193178,6.126137,8.302655,-3.425995,15.956462,15.956027,17.856944,14.741838,6.996978,9.660151,5.612651,6.325006,6.336636,2.096888,9.96303,22.300687,-1.076296,39.0892,9.648031,-2.759742,39.086872,-2.232851,-2.577358,37.988251,-2.800117,-0.544217,7.019835,-3.149178,-6.454494,-8.218068,2.512036,39.933946,15.938992,-4.13731,23.103374,27.659485,-2.886122,8.640752,16.296984,37.972643,-0.348489,9.374283,9.369031,-0.071722,-8.168511,33.746972,33.75983,-0.850227,15.601795,-0.161167,-0.330764,15.98852,-4.612836,-6.656727,15.054331,-0.502605,1.669722,-8.090871,-5.428717,-8.685672,-6.993684,7.438208,-8.278134,2.161517,-4.405767,-8.584618,29.872077,-8.200918,15.598832,17.710992,1.105203,-1.320215,-5.095278,-8.485265,16.3268,16.144572,16.245288,16.245471,5.728218,-5.7361,-1.949643,-1.949353,4.6,4.6,4.05,3.5,3.5,-1.930033,7.046901,4.05,4.55,6.45,-5.450935,6.041162,6.75324,4.3,4.3,4.3,4.3,-0.460582,4.65,6.753484,4.8,3.6,9.93928,-2.430617,-4.112136,5.75,3.55,-5.73376,3.55,16.158469,-8.215,3.55,-5.66427,-1.549853,4.6,15.233616,5.8,4.05,-5.86831,-1.49793,4.5,5.55,3.5,-8.015614,-1.561689,14.791878,4.5,5.8,0.943776,4.35,0.598747,4.65,6.506793,5.85,4.2,5.75,3.55,6.15,4.55,-0.033097,3.55,4.6,4.55,4.05,0.509585,0.498304,13.021505,4.55,-1.327885,4.55,4.55,0.663056,4.05,3.527487,4.65,-1.07654,5.75,-8.52094,4.6,-5.201504,-1.222794,-5.584009,-0.01197,0.540404,-5.217759,-2.692994,-1.993693,0.162509,9.16103,-2.66401,-1.244935,-0.027118,3.05852,5.641402,6.013628,5.95106,5.950917,5.950036,10.667254,-1.732266,10.701789,-3.041878,10.712671,-2.853475,-1.129174,39.71299,39.712881,39.684842,16.30538,8.649683,-6.540042,-7.63106,-1.967375,16.288713,7.964439,-2.559355,15.921937,-1.310577,39.047117,-2.182377,39.126029,16.240016,16.237728,16.15857,-2.420731,19.058719,16.224654,16.223763,38.144936,-4.233993,-0.53564,4.417776,6.923611,9.104147,16.246883,16.246821,16.248017,16.248186,6.12253,0.904854,2.356984,4.868263,10.20614,15.634202,11.016222,16.334612,6.087084,34.085425,9.15745,10.380233,-1.333464,-1.319878,-3.853357,-0.341955,-4.243383,8.730537,16.275988,15.385301,15.592225,5.867673,-3.782457,39.654629,-0.877723,-4.0789,9.277953,15.939289,16.223297,-3.278078,16.106198,16.121925,5.462639,16.292148,15.70784,16.287242,-2.868808,-8.567893,-85.367172,33.832756,-1.709421,9.166437,-0.446988,6.489113,10.048717,8.255024,15.377505,16.321603,16.479208,-5.42724,4.835742,-5.593048,9.703596,9.643584,9.974813,-3.14321,16.174095,6.954492,8.61375,-3.600451,9.553077,16.514256,16.514256,7.240146,-3.506107,6.06935,8.13979,-3.738191,9.547786,-2.41043,1.377968,15.610078,4.522591,12.228558,7.240146,10.769137,12.52691,4.866329,8.687469,-3.755788,-7.857664,-3.442841,-2.202717,8.040321,4.872254,9.209217,11.303304,0.113334,7.435274,16.388589,-3.214622,14.91878,8.167822,39.093889,-8.504097,-2.004654,15.482052,-0.489638,9.80592,15.434719,8.907709,15.434826,15.434822,15.434781,11.405488,11.405324,16.216895,16.229386,38.745713,39.126208,9.583536,15.433265,15.433366,15.432971,15.432983,15.456905,16.347433,15.499747,9.762078,41.67968,7.494961,9.385773,11.21507,29.76464,29.76464,29.76464,29.76464,29.77357,9.541808,34.855827,16.334983,-8.412591,15.920688,8.324631,0.336683,0.336506,0.339058,15.434716,15.434724,15.434702,9.198715,4.86767,0.338964,0.338975,0.338973,0.336534,0.336609,0.336558,0.339106,-0.290334,-5.483657,16.225288,8.630561,16.112177,7.659438,0.336511,16.124802,-4.979617,11.20354,7.788926,-1.785981,16.103942,-2.673383,-7.65077,-7.655378,-1.713069,16.24714,-5.255205,2.183938,15.245072,17.681428,17.679992,17.680087,18.438263,15.701734,9.585114,15.995939,13.90941,13.90941,-1.411085,8.299995,17.680029,-6.156015,-1.505142,37.9631,37.962455,37.962287,7.907593,10.678856,16.109133,16.306618,11.30248,15.924505,15.353804,15.798421,-7.529639,5.928496,15.931635,6.683245,16.372429,0.254271,6.226347,23.542061,16.293449,-2.241584,-1.319915,2.209042,35.079614,35.077542,8.603528,2.182043,15.699488,9.451474,-3.208538,7.102734,8.48124,-0.086253,14.379037,18.451226,14.774378,-0.116014,16.223105,0.09782,8.9059,-2.304424,8.918381,11.033954,-2.74127,15.338953,16.198983,1.38,1.387025,10.372262,-0.526795,14.26051,-0.380554,7.384947,16.230865,9.161448,16.231898,7.384502,0.23286,8.467801,15.891189,16.227405,9.63899,15.482588,15.482755,-0.047518,7.977714,39.980237,39.980362,-6.078257,6.324497,1.37164,39.967317,8.664056,15.432672,39.968362,16.22396,8.488758,15.335431,11.451225,9.396272,15.606959,11.064771,11.64238,6.272914,9.780919,41.718647,16.258419,3.133743,15.929417,2.499967,-2.986357,-2.986122,-2.986298,-2.986042,-2.986273,-2.98687,16.335747,-0.243543,0.323303,-2.986306,-2.758657,15.706959,19.163279,2.197133,10.887242,13.303761,8.939069,8.157037,10.654368,-3.481838,-3.958998,-0.242172,-0.241811,15.413799,16.170022,-9.197991,17.903514,37.344196,-2.233851,-2.75213,35.095782,-3.901787,8.154526,-0.270537,-5.446092,0.177161,-3.231712,-1.23522,-3.090143,-117.638205,-1.232898,33.751447,17.619954,-2.507653,-7.498833,-2.98483,-5.97422,-5.97422,-9.394417,8.000592,0.148484,0.486503,11.771333,10.583052,15.415603,34.213404,15.458542,7.920473,10.807649,10.807724,10.811399,0.473102,16.479563,10.2055,8.075792,11.57092,7.892596,7.240146,13.908703,31.281969,31.282025,16.115378,-0.840688,-8.665489,-0.570156,10.893245,7.892212,16.243917,2.186439,-0.360905,14.740283,-3.075931,-1.307963,-5.795091,-5.790161,-5.793596,-1.694089,7.920463,-0.547705,7.490686,-2.040435,-2.045189,-2.018652,-2.012472,14.421389,15.438666,0.222062],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[33.57118,59.209705],"lng":[-117.638205,41.718647]}},"evals":[],"jsHooks":[]}</script>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
